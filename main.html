<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador Oficial - Copa do Mundo 2026</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #1a2980;
            --secondary: #26d0ce;
            --accent: #ff4757;
            --success: #2ed573;
            --warning: #ffa502;
            --light: #f1f2f6;
            --dark: #2f3542;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            --radius: 12px;
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0c2461 0%, #1e3799 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1800px;
            margin: 0 auto;
        }
        
        /* HEADER */
        header {
            background: rgba(255, 255, 255, 0.98);
            border-radius: var(--radius);
            padding: 30px 40px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            text-align: center;
            border-bottom: 5px solid var(--accent);
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent));
        }
        
        h1 {
            color: var(--primary);
            font-size: 2.8rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }
        
        h1 i {
            color: var(--accent);
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .tournament-info {
            background: linear-gradient(135deg, #e3f2fd, #e8f5e9);
            border-radius: var(--radius);
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid var(--secondary);
            text-align: left;
        }
        
        .tournament-info h3 {
            color: var(--primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .tournament-info ul {
            padding-left: 20px;
            line-height: 1.6;
        }
        
        .tournament-info li {
            margin-bottom: 8px;
            font-size: 1.1rem;
        }
        
        .controls {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 25px;
        }
        
        .btn {
            padding: 15px 32px;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--secondary), #1e90ff);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(30, 144, 255, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success), #1dd1a1);
            color: white;
        }
        
        .btn-success:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(46, 213, 115, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--accent), #ff3838);
            color: white;
        }
        
        .btn-danger:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 71, 87, 0.3);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning), #ff7f00);
            color: white;
        }
        
        .btn-warning:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 165, 2, 0.3);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }
        
        /* SE√á√ÉO DOS GRUPOS */
        .groups-section {
            background: rgba(255, 255, 255, 0.98);
            border-radius: var(--radius);
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: var(--shadow);
        }
        
        .groups-section h2 {
            color: var(--primary);
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid var(--secondary);
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 1.8rem;
        }
        
        .groups-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        
        .group-card {
            background: white;
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
            border-top: 5px solid var(--secondary);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }
        
        .group-card::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--secondary), var(--primary));
        }
        
        .group-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.12);
        }
        
        .group-card h3 {
            color: var(--primary);
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.6rem;
            position: relative;
            display: inline-block;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .team-list {
            list-style: none;
            min-height: 280px;
        }
        
        .team-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: grab;
            transition: var(--transition);
            border-left: 5px solid transparent;
            position: relative;
            user-select: none;
        }
        
        .team-item:active {
            cursor: grabbing;
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .team-item.primeiro {
            border-left-color: #00b894;
            background: linear-gradient(90deg, #f0fff4, #ffffff);
        }
        
        .team-item.segundo {
            border-left-color: #0984e3;
            background: linear-gradient(90deg, #f0f8ff, #ffffff);
        }
        
        .team-item.terceiro {
            border-left-color: #fdcb6e;
            background: linear-gradient(90deg, #fffaf0, #ffffff);
        }
        
        .team-item.quarto {
            border-left-color: #636e72;
            background: linear-gradient(90deg, #f8f9fa, #ffffff);
        }
        
        .team-pos {
            background: var(--primary);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1rem;
            flex-shrink: 0;
        }
        
        .team-flag {
            font-size: 1.8rem;
            flex-shrink: 0;
        }
        
        .team-name {
            flex-grow: 1;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .drag-info {
            background: linear-gradient(135deg, var(--primary), var(--dark));
            color: white;
            border-radius: 50px;
            padding: 10px 25px;
            font-size: 1rem;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        /* MODAL DE SELE√á√ÉO DOS TERCEIROS (REMODELADO) */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal-overlay.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }
        
        .modal {
            background: white;
            border-radius: var(--radius);
            padding: 30px;
            max-width: 1200px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        .modal h2 {
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
            font-size: 2rem;
        }
        
        .modal-subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1rem;
            line-height: 1.5;
        }
        
        .selection-instruction {
            background: #f0f8ff;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 5px solid var(--secondary);
        }
        
        .selection-instruction h4 {
            color: var(--primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .selection-instruction p {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        
        .selection-instruction i {
            color: var(--secondary);
        }
        
        .selection-instruction .important {
            background: #ffeaa7;
            padding: 10px 15px;
            border-radius: 8px;
            margin-top: 10px;
            border-left: 4px solid #fdcb6e;
        }
        
        .selection-area {
            display: flex;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .available-teams, .selected-teams {
            flex: 1;
        }
        
        .selection-area h3 {
            color: var(--primary);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
            font-size: 1.3rem;
        }
        
        .terceiros-container, .melhores-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            min-height: 400px;
            border: 2px dashed #ddd;
        }
        
        .melhores-container {
            background: #e8f5e9;
            border-color: var(--success);
        }
        
        .terceiro-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: grab;
            transition: var(--transition);
            border: 2px solid transparent;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }
        
        .terceiro-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .terceiro-item:active {
            cursor: grabbing;
        }
        
        .terceiro-item .team-flag {
            font-size: 1.5rem;
        }
        
        .terceiro-item .team-name {
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .terceiro-group {
            font-size: 0.9rem;
            color: #666;
            margin-top: 2px;
        }
        
        .slot {
            background: white;
            border-radius: 8px;
            padding: 15px 20px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: var(--transition);
            border: 2px dashed #ccc;
            min-height: 70px;
        }
        
        .slot.filled {
            border: 2px solid var(--success);
            background: #f0fff4;
        }
        
        .slot-number {
            background: var(--primary);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1rem;
            flex-shrink: 0;
        }
        
        .slot-label {
            color: #666;
            font-style: italic;
            flex-grow: 1;
        }
        
        .slot.filled .slot-label {
            color: #333;
            font-style: normal;
            font-weight: 600;
        }
        
        .counter-display {
            text-align: center;
            font-size: 1.2rem;
            margin-bottom: 25px;
            padding: 15px;
            border-radius: 10px;
            background: #f8f9fa;
            font-weight: 600;
        }
        
        .counter-display span {
            color: var(--primary);
        }
        
        .modal-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
            transition: var(--transition);
        }
        
        .close-modal:hover {
            color: var(--accent);
        }
        
        /* CONTROLE DE FASES E INDICADOR DE FASE */
        .phase-indicator {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-radius: var(--radius);
            padding: 20px 30px;
            margin-bottom: 25px;
            text-align: center;
            box-shadow: var(--shadow);
            display: none;
            border-left: 8px solid var(--accent);
        }
        
        .phase-indicator.active {
            display: block;
            animation: slideDown 0.5s ease;
        }
        
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .phase-indicator h3 {
            font-size: 1.6rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .phase-indicator p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-top: 8px;
        }
        
        .phase-control-above {
            background: linear-gradient(135deg, #ffffff, #f8f9fa);
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            display: none;
        }
        
        .phase-control-above.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .phase-control-above h3 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.5rem;
            text-align: center;
        }
        
        .phase-control-above p {
            color: #666;
            margin-bottom: 20px;
            font-size: 1.1rem;
            text-align: center;
        }
        
        .phase-control-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .btn-phase {
            padding: 18px 40px;
            font-size: 1.2rem;
            background: linear-gradient(135deg, var(--success), #1dd1a1);
            border: none;
            border-radius: 50px;
            color: white;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 8px 25px rgba(46, 213, 115, 0.3);
        }
        
        .btn-phase:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 12px 30px rgba(46, 213, 115, 0.4);
        }
        
        .btn-back {
            padding: 18px 40px;
            font-size: 1.2rem;
            background: linear-gradient(135deg, var(--warning), #ff7f00);
            border: none;
            border-radius: 50px;
            color: white;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 8px 25px rgba(255, 165, 2, 0.3);
        }
        
        .btn-back:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 12px 30px rgba(255, 165, 2, 0.4);
        }
        
        /* SE√á√ÉO DO CHAVEAMENTO */
        .bracket-section {
            background: rgba(255, 255, 255, 0.98);
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
            margin-top: 20px;
            display: none;
        }
        
        .bracket-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .bracket-section h2 {
            color: var(--primary);
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid var(--accent);
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 1.8rem;
            text-align: center;
        }
        
        .bracket-container {
            position: relative;
            min-height: 800px;
            overflow-x: auto;
            padding: 20px 0;
            -webkit-overflow-scrolling: touch;
        }
        
        .bracket {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            position: relative;
            min-width: 1600px;
            margin: 0 auto;
        }
        
        .round-column {
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            flex: 1;
            min-height: 850px;
            padding: 0 10px;
        }
        
        .round-column.left {
            align-items: flex-start;
        }
        
        .round-column.right {
            align-items: flex-end;
        }
        
        .round-column.center {
            align-items: center;
            flex: 0.6;
        }
        
        .round-title {
            text-align: center;
            color: var(--primary);
            margin-bottom: 30px;
            font-size: 1.4rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--light), #ffffff);
            padding: 10px 20px;
            border-radius: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            width: fit-content;
            align-self: center;
        }
        
        .match {
            background: white;
            border-radius: 10px;
            padding: 0;
            margin: 12px 0;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid #e9ecef;
            transition: var(--transition);
            width: 240px;
            position: relative;
            overflow: hidden;
        }
        
        .match:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.12);
        }
        
        .match::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--secondary), var(--primary));
        }
        
        .team {
            padding: 16px 18px;
            margin: 0;
            border-bottom: 1px solid #f1f2f6;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
            position: relative;
        }
        
        .team:last-child {
            border-bottom: none;
        }
        
        .team:hover {
            background: #f8f9fa;
        }
        
        .team.winner {
            background: linear-gradient(90deg, #e8f5e9, #ffffff);
            font-weight: 700;
            color: #00b894;
        }
        
        .team.winner::after {
            content: "‚úì";
            color: #00b894;
            font-weight: bold;
            font-size: 1.2rem;
            margin-left: 10px;
        }
        
        .team .flag {
            font-size: 1.4rem;
            margin-right: 12px;
        }
        
        .team .name {
            flex-grow: 1;
            font-size: 1rem;
        }
        
        .final-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
            align-items: center;
            justify-content: center;
            height: 100%;
        }
        
        .final-match {
            width: 280px;
            border: 2px solid var(--accent);
            box-shadow: 0 10px 30px rgba(255, 71, 87, 0.15);
        }
        
        .final-match::before {
            content: "üèÜ FINAL";
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, var(--accent), #ff3838);
            color: white;
            padding: 6px 20px;
            border-radius: 30px;
            font-size: 0.9rem;
            font-weight: bold;
            z-index: 2;
        }
        
        .third-place {
            width: 260px;
            border: 2px solid #fdcb6e;
        }
        
        .third-place::before {
            content: "ü•â 3¬∫ LUGAR";
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
            padding: 6px 20px;
            border-radius: 30px;
            font-size: 0.9rem;
            font-weight: bold;
            z-index: 2;
        }
        
        .match-number {
            text-align: center;
            padding: 5px;
            font-size: 0.8rem;
            color: #666;
            border-top: 1px solid #eee;
            background: #f8f9fa;
            border-bottom-left-radius: 10px;
            border-bottom-right-radius: 10px;
        }
        
        /* BOT√ÉO DE VOLTAR FASE FIXO */
        .back-phase-fixed {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 100;
            display: none;
        }
        
        .back-phase-fixed.active {
            display: block;
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(50px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        /* STATUS BAR */
        .status-bar {
            background: white;
            border-radius: var(--radius);
            padding: 20px 30px;
            margin-top: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .status {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .status-icon {
            width: 16px;
            height: 16px;
            border-radius: 50%;
        }
        
        .status-icon.active {
            background: var(--success);
            animation: pulse 1.5s infinite;
            box-shadow: 0 0 0 0 rgba(46, 213, 115, 0.7);
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(46, 213, 115, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(46, 213, 115, 0); }
            100% { box-shadow: 0 0 0 0 rgba(46, 213, 115, 0); }
        }
        
        .status-icon.waiting {
            background: #fdcb6e;
        }
        
        .status-text {
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        /* FOOTER */
        footer {
            text-align: center;
            margin-top: 40px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 1rem;
            padding: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* RESPONSIVIDADE */
        @media (max-width: 1600px) {
            .bracket {
                min-width: 1400px;
            }
        }
        
        @media (max-width: 1400px) {
            .bracket {
                min-width: 1200px;
            }
            
            .match {
                width: 200px;
            }
        }
        
        @media (max-width: 1200px) {
            .bracket {
                min-width: 1000px;
            }
            
            .match {
                width: 180px;
            }
            
            .team {
                padding: 14px 16px;
            }
            
            .selection-area {
                flex-direction: column;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            header {
                padding: 20px;
            }
            
            h1 {
                font-size: 2rem;
                flex-direction: column;
                gap: 10px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
                justify-content: center;
                padding: 12px 24px;
            }
            
            .groups-container {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 15px;
            }
            
            .team-item {
                padding: 12px;
                gap: 10px;
            }
            
            .modal {
                padding: 20px;
                max-height: 85vh;
            }
            
            .terceiros-container, .melhores-container {
                min-height: 300px;
            }
            
            .bracket {
                min-width: 900px;
            }
            
            .round-column {
                min-height: 700px;
            }
            
            .match {
                width: 160px;
            }
            
            .team {
                padding: 12px 14px;
            }
            
            .team .name {
                font-size: 0.9rem;
            }
            
            .final-match {
                width: 220px;
            }
            
            .third-place {
                width: 200px;
            }
            
            .phase-control-buttons {
                flex-direction: column;
            }
            
            .btn-phase, .btn-back {
                width: 100%;
                justify-content: center;
                padding: 15px 30px;
                font-size: 1.1rem;
            }
            
            .back-phase-fixed {
                position: static;
                margin-top: 20px;
                text-align: center;
                width: 100%;
            }
            
            .back-phase-fixed.active {
                display: flex;
                justify-content: center;
            }
            
            .phase-indicator {
                padding: 15px 20px;
            }
            
            .phase-indicator h3 {
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-futbol"></i> Simulador Oficial - Copa do Mundo 2026</h1>
            <p class="subtitle">Novo formato: 48 sele√ß√µes, 12 grupos, fase de 16-avos (Chaveamento OFICIAL FIFA)</p>
            
            <div class="tournament-info">
                <h3><i class="fas fa-info-circle"></i> Como funciona a Copa 2026:</h3>
                <ul>
                    <li><strong>48 sele√ß√µes</strong> divididas em <strong>12 grupos de 4 times</strong></li>
                    <li>Classificam os <strong>2 primeiros de cada grupo (24 times)</strong> + <strong>8 melhores terceiros</strong></li>
                    <li><strong>32 times</strong> avan√ßam para o mata-mata com chaveamento FIXO da FIFA</li>
                    <li><strong>Nova fase:</strong> 16-avos de final (Round of 32)</li>
                    <li>Campe√£o joga <strong>8 partidas</strong> (antes eram 7)</li>
                </ul>
            </div>
            
            <div class="controls">
                <button class="btn btn-primary" id="btn-montar-chaveamento">
                    <i class="fas fa-sitemap"></i> Montar Chaveamento Oficial (32 times)
                </button>
                <button class="btn btn-success" id="btn-reset-grupos">
                    <i class="fas fa-redo"></i> Redefinir Grupos
                </button>
                <button class="btn btn-danger" id="btn-nova-simulacao">
                    <i class="fas fa-fire"></i> Nova Simula√ß√£o
                </button>
            </div>
        </header>
        
        <section class="groups-section">
            <h2><i class="fas fa-list-ol"></i> Fase de Grupos (12 Grupos)</h2>
            <p class="drag-info"><i class="fas fa-arrows-alt"></i> Arraste os times para definir a classifica√ß√£o (1¬∫ a 4¬∫ lugar)</p>
            
            <div class="groups-container" id="grupos-container">
                <!-- Grupos ser√£o gerados aqui -->
            </div>
        </section>
        
        <!-- MODAL DE SELE√á√ÉO DOS TERCEIROS COLOCADOS (REMODELADO) -->
        <div class="modal-overlay" id="modal-terceiros">
            <div class="modal">
                <button class="close-modal" id="close-modal">&times;</button>
                
                <h2><i class="fas fa-users"></i> Selecionar e Ordenar os 8 Melhores Terceiros</h2>
                <p class="modal-subtitle">Arraste os 8 terceiros colocados da esquerda para a direita, ordenando-os do MELHOR (1¬∫) para o OITAVO (8¬∫) melhor</p>
                
                <div class="selection-instruction">
                    <h4><i class="fas fa-info-circle"></i> Como funciona a sele√ß√£o dos melhores terceiros:</h4>
                    <p>1. A FIFA classifica os 8 melhores terceiros com base em: <strong>pontos, saldo de gols, gols pr√≥, cart√µes e ranking FIFA</strong>.</p>
                    <p>2. No simulador, <strong>VOC√ä define essa classifica√ß√£o</strong> atrav√©s da ordem de arraste.</p>
                    <p>3. <strong>A ordem importa!</strong> O primeiro time que voc√™ colocar na lista ser√° considerado o MELHOR terceiro colocado, o segundo ser√° o SEGUNDO melhor, e assim por diante.</p>
                    <div class="important">
                        <strong>Importante:</strong> Cada jogo dos 16-avos tem combina√ß√µes espec√≠ficas de grupos permitidos para os terceiros colocados. O simulador usar√° SUA classifica√ß√£o para alocar os times nos jogos seguindo as regras oficiais da FIFA.
                    </div>
                </div>
                
                <div class="counter-display">
                    Selecionados: <span id="contador-selecionados">0</span> de 8 terceiros colocados
                </div>
                
                <div class="selection-area">
                    <div class="available-teams">
                        <h3>Terceiros Dispon√≠veis (12)</h3>
                        <div class="terceiros-container" id="terceiros-disponiveis">
                            <!-- Lista de terceiros dispon√≠veis ser√° gerada aqui -->
                        </div>
                    </div>
                    
                    <div class="selected-teams">
                        <h3>Melhores Terceiros (Ordenados do Melhor ao Oitavo)</h3>
                        <div class="melhores-container" id="melhores-container">
                            <!-- 8 slots para os terceiros selecionados -->
                            <div class="slot" data-slot="1">
                                <div class="slot-number">1</div>
                                <div class="slot-label">Melhor terceiro colocado</div>
                            </div>
                            <div class="slot" data-slot="2">
                                <div class="slot-number">2</div>
                                <div class="slot-label">2¬∫ melhor terceiro</div>
                            </div>
                            <div class="slot" data-slot="3">
                                <div class="slot-number">3</div>
                                <div class="slot-label">3¬∫ melhor terceiro</div>
                            </div>
                            <div class="slot" data-slot="4">
                                <div class="slot-number">4</div>
                                <div class="slot-label">4¬∫ melhor terceiro</div>
                            </div>
                            <div class="slot" data-slot="5">
                                <div class="slot-number">5</div>
                                <div class="slot-label">5¬∫ melhor terceiro</div>
                            </div>
                            <div class="slot" data-slot="6">
                                <div class="slot-number">6</div>
                                <div class="slot-label">6¬∫ melhor terceiro</div>
                            </div>
                            <div class="slot" data-slot="7">
                                <div class="slot-number">7</div>
                                <div class="slot-label">7¬∫ melhor terceiro</div>
                            </div>
                            <div class="slot" data-slot="8">
                                <div class="slot-number">8</div>
                                <div class="slot-label">8¬∫ melhor terceiro</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-buttons">
                    <button class="btn btn-success" id="btn-confirmar-terceiros" disabled>
                        <i class="fas fa-check"></i> Confirmar e Gerar Chaveamento Oficial
                    </button>
                    <button class="btn btn-warning" id="btn-cancelar-selecao">
                        <i class="fas fa-times"></i> Cancelar
                    </button>
                </div>
            </div>
        </div>
        
        <!-- INDICADOR DE FASE ATUAL -->
        <div class="phase-indicator" id="phase-indicator">
            <h3><i class="fas fa-arrow-pointer"></i> <span id="current-phase-text">Selecionando vencedores</span></h3>
            <p id="phase-instruction">Clique em um time para definir o vencedor do confronto</p>
        </div>
        
        <!-- CONTROLE DE FASES (ACIMA DO CHAVEAMENTO) -->
        <div class="phase-control-above" id="phase-control-above">
            <!-- Conte√∫do ser√° inserido dinamicamente -->
        </div>
        
        <section class="bracket-section" id="bracket-section">
            <h2><i class="fas fa-trophy"></i> Chaveamento Oficial FIFA - Fase Final (32 times)</h2>
            
            <div class="bracket-container">
                <div class="bracket" id="chaveamento-container">
                    <!-- Coluna dos 16-avos (Esquerda) -->
                    <div class="round-column left" id="round-32-left">
                        <div class="round-title">16-avos - Esquerda</div>
                    </div>
                    
                    <!-- Coluna das Oitavas (Esquerda) -->
                    <div class="round-column left" id="round-16-left">
                        <div class="round-title">Oitavas - Esquerda</div>
                    </div>
                    
                    <!-- Coluna das Quartas (Esquerda) -->
                    <div class="round-column left" id="quarters-left">
                        <div class="round-title">Quartas - Esquerda</div>
                    </div>
                    
                    <!-- Coluna das Semifinais (Esquerda) -->
                    <div class="round-column left" id="semis-left">
                        <div class="round-title">Semifinais - Esquerda</div>
                    </div>
                    
                    <!-- Coluna Central (Final e 3¬∫ Lugar) -->
                    <div class="round-column center" id="round-center">
                        <div class="final-container">
                            <div class="match final-match" id="final-match">
                                <div class="team" data-team="final-1">
                                    <span><span class="flag">üè¥</span> <span class="name">A definir</span></span>
                                </div>
                                <div class="team" data-team="final-2">
                                    <span><span class="flag">üè¥</span> <span class="name">A definir</span></span>
                                </div>
                            </div>
                            
                            <div class="match third-place" id="third-place-match">
                                <div class="team" data-team="third-1">
                                    <span><span class="flag">üè¥</span> <span class="name">A definir</span></span>
                                </div>
                                <div class="team" data-team="third-2">
                                    <span><span class="flag">üè¥</span> <span class="name">A definir</span></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Coluna das Semifinais (Direita) -->
                    <div class="round-column right" id="semis-right">
                        <div class="round-title">Semifinais - Direita</div>
                    </div>
                    
                    <!-- Coluna das Quartas (Direita) -->
                    <div class="round-column right" id="quarters-right">
                        <div class="round-title">Quartas - Direita</div>
                    </div>
                    
                    <!-- Coluna das Oitavas (Direita) -->
                    <div class="round-column right" id="round-16-right">
                        <div class="round-title">Oitavas - Direita</div>
                    </div>
                    
                    <!-- Coluna dos 16-avos (Direita) -->
                    <div class="round-column right" id="round-32-right">
                        <div class="round-title">16-avos - Direita</div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- BOT√ÉO FIXO PARA VOLTAR FASE -->
        <div class="back-phase-fixed" id="back-phase-fixed">
            <button class="btn btn-warning" id="btn-voltar-fase-fixo">
                <i class="fas fa-undo"></i> Voltar Fase
            </button>
        </div>
        
        <div class="status-bar">
            <div class="status">
                <div class="status-icon waiting" id="status-grupos"></div>
                <span class="status-text">Fase de Grupos: <strong id="status-text-grupos">Aguardando defini√ß√£o</strong></span>
            </div>
            <div class="status">
                <div class="status-icon waiting" id="status-mata"></div>
                <span class="status-text">Fase Mata-Mata: <strong id="status-text-mata">N√£o iniciada</strong></span>
            </div>
            <div class="status">
                <div class="status-icon waiting" id="status-fase"></div>
                <span class="status-text">Fase Atual: <strong id="status-text-fase">-</strong></span>
            </div>
        </div>
        
        <footer>
            <p>Simulador do Novo Formato da Copa do Mundo 2026 | 48 sele√ß√µes, 12 grupos, fase de 16-avos</p>
            <p>Chaveamento baseado no calend√°rio oficial FIFA publicado em 15 de Junho de 2024</p>
        </footer>
    </div>

    <script>
        // DADOS DOS 12 GRUPOS - FORMATO COPA 2026
        const gruposData = [
            { letra: 'A', times: ['M√©xico', '√Åfrica do Sul', 'Coreia do Sul', 'Rep√∫blica Tcheca'] },
            { letra: 'B', times: ['Canad√°', 'It√°lia', 'Catar', 'Su√≠√ßa'] },
            { letra: 'C', times: ['Brasil', 'Marrocos', 'Haiti', 'Esc√≥cia'] },
            { letra: 'D', times: ['Estados Unidos', 'Paraguai', 'Austr√°lia', 'Turquia'] },
            { letra: 'E', times: ['Alemanha', 'Cura√ßao', 'Costa do Marfim', 'Equador'] },
            { letra: 'F', times: ['Holanda', 'Jap√£o', 'Ucr√¢nia', 'Tun√≠sia'] },
            { letra: 'G', times: ['B√©lgica', 'Egito', 'Ir√£', 'Nova Zel√¢ndia'] },
            { letra: 'H', times: ['Espanha', 'Cabo Verde', 'Ar√°bia Saudita', 'Uruguai'] },
            { letra: 'I', times: ['Fran√ßa', 'Senegal', 'Bol√≠via', 'Noruega'] },
            { letra: 'J', times: ['Argentina', 'Arg√©lia', '√Åustria', 'Jord√¢nia'] },
            { letra: 'K', times: ['Portugal', 'RD Congo', 'Uzbequist√£o', 'Col√¥mbia'] },
            { letra: 'L', times: ['Inglaterra', 'Cro√°cia', 'Gana', 'Panam√°'] }
        ];

        // Bandeiras para os times
        const flags = {
            'Brasil': 'üáßüá∑', 'Argentina': 'üá¶üá∑', 'Fran√ßa': 'üá´üá∑', 'Alemanha': 'üá©üá™',
            'Espanha': 'üá™üá∏', 'Inglaterra': 'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø', 'Portugal': 'üáµüáπ', 'B√©lgica': 'üáßüá™',
            'Holanda': 'üá≥üá±', 'It√°lia': 'üáÆüáπ', 'Cro√°cia': 'üá≠üá∑', 'Uruguai': 'üá∫üáæ',
            'M√©xico': 'üá≤üáΩ', 'Estados Unidos': 'üá∫üá∏', 'Canad√°': 'üá®üá¶', 'Jap√£o': 'üáØüáµ',
            'Coreia do Sul': 'üá∞üá∑', 'Austr√°lia': 'üá¶üá∫', 'Marrocos': 'üá≤üá¶', 'Senegal': 'üá∏üá≥',
            'Egito': 'üá™üá¨', 'Gana': 'üá¨üá≠', 'Catar': 'üá∂üá¶', 'Ar√°bia Saudita': 'üá∏üá¶',
            'Ir√£': 'üáÆüá∑', 'Col√¥mbia': 'üá®üá¥', 'Paraguai': 'üáµüáæ', 'Chile': 'üá®üá±',
            'Equador': 'üá™üá®', 'Peru': 'üáµüá™', 'Su√≠√ßa': 'üá®üá≠', 'Su√©cia': 'üá∏üá™',
            'Pol√¥nia': 'üáµüá±', '√Åustria': 'üá¶üáπ', 'Ucr√¢nia': 'üá∫üá¶', 'Turquia': 'üáπüá∑',
            'Rep√∫blica Tcheca': 'üá®üáø', 'Esc√≥cia': 'üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø', 'Noruega': 'üá≥üá¥', 'Costa do Marfim': 'üá®üáÆ',
            'Tun√≠sia': 'üáπüá≥', 'Arg√©lia': 'üá©üáø', 'Nig√©ria': 'üá≥üá¨', 'Cabo Verde': 'üá®üáª',
            'Haiti': 'üá≠üáπ', 'Panam√°': 'üáµüá¶', 'Bol√≠via': 'üáßüá¥', 'RD Congo': 'üá®üá©',
            'Nova Zel√¢ndia': 'üá≥üáø', 'Jord√¢nia': 'üáØüá¥', 'Uzbequist√£o': 'üá∫üáø', 'Cura√ßao': 'üá®üáº',
            '√Åfrica do Sul': 'üáøüá¶'
        };

        // Estado da simula√ß√£o
        let grupoOrdenado = JSON.parse(JSON.stringify(gruposData));
        let classificados = { 
            primeiros: [],   // 12 times (1¬∫ de cada grupo)
            segundos: [],    // 12 times (2¬∫ de cada grupo)
            terceiros: []    // 8 melhores terceiros (ORDENADOS PELO USU√ÅRIO)
        };
        
        let todosTerceirosDisponiveis = [];
        let melhoresTerceirosOrdenados = []; // Array ordenado do melhor (0) para o pior (7)
        
        // ESTRUTURA DO CHAVEAMENTO OFICIAL FIFA
        let chaveamentoOficial = { 
            r32: Array(16).fill(null).map((_, i) => ({ 
                a: null, 
                b: null, 
                vencedor: null, 
                numero: 73 + i 
            })),
            r16: Array(8).fill(null).map((_, i) => ({ 
                a: null, 
                b: null, 
                vencedor: null, 
                numero: 89 + i 
            })),
            qf: Array(4).fill(null).map((_, i) => ({ 
                a: null, 
                b: null, 
                vencedor: null, 
                numero: 97 + i 
            })),
            sf: Array(2).fill(null).map((_, i) => ({ 
                a: null, 
                b: null, 
                vencedor: null, 
                numero: 101 + i 
            })),
            final: [{ a: null, b: null, vencedor: null, numero: 104 }],
            terceiro: [{ a: null, b: null, vencedor: null, numero: 103 }]
        };
        
        let faseAtual = '32avos';
        let todasFasesCompletas = false;
        let historicoFases = [];
        let itemArrastando = null;

        // Inicializa a p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            renderizarGrupos();
            configurarEventos();
            atualizarStatus();
        });

        // Renderiza os 12 grupos com drag-and-drop
        function renderizarGrupos() {
            const container = document.getElementById('grupos-container');
            container.innerHTML = '';
            
            grupoOrdenado.forEach(grupo => {
                const groupCard = document.createElement('div');
                groupCard.className = 'group-card';
                groupCard.innerHTML = `
                    <h3>Grupo ${grupo.letra}</h3>
                    <ul class="team-list" data-grupo="${grupo.letra}" id="grupo-${grupo.letra}">
                        ${grupo.times.map((time, index) => `
                            <li class="team-item ${index === 0 ? 'primeiro' : index === 1 ? 'segundo' : index === 2 ? 'terceiro' : 'quarto'}" 
                                data-time="${time}" data-grupo="${grupo.letra}" draggable="true">
                                <div class="team-pos">${index + 1}</div>
                                <div class="team-flag">${flags[time] || 'üè¥'}</div>
                                <div class="team-name">${time}</div>
                                <i class="fas fa-arrows-alt-v" style="color: #aaa;"></i>
                            </li>
                        `).join('')}
                    </ul>
                `;
                
                container.appendChild(groupCard);
            });
            
            configurarDragAndDrop();
        }

        // Configura√ß√£o do drag-and-drop para grupos
        function configurarDragAndDrop() {
            const lists = document.querySelectorAll('.team-list');
            
            lists.forEach(list => {
                list.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    const afterElement = getDragAfterElement(list, e.clientY);
                    const draggable = document.querySelector('.team-item.dragging');
                    
                    if (draggable && list.dataset.grupo === draggable.dataset.grupo) {
                        if (afterElement == null) {
                            list.appendChild(draggable);
                        } else {
                            list.insertBefore(draggable, afterElement);
                        }
                    }
                });
                
                list.addEventListener('dragenter', (e) => {
                    e.preventDefault();
                });
                
                list.addEventListener('drop', (e) => {
                    e.preventDefault();
                    if (itemArrastando) {
                        const afterElement = getDragAfterElement(list, e.clientY);
                        if (afterElement == null) {
                            list.appendChild(itemArrastando);
                        } else {
                            list.insertBefore(itemArrastando, afterElement);
                        }
                        atualizarOrdemGrupo(list.dataset.grupo);
                        atualizarStatus();
                    }
                });
            });
            
            document.querySelectorAll('.team-item').forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    itemArrastando = e.target;
                    e.target.classList.add('dragging');
                    setTimeout(() => {
                        e.target.style.opacity = '0.4';
                    }, 0);
                });
                
                item.addEventListener('dragend', (e) => {
                    e.target.classList.remove('dragging');
                    e.target.style.opacity = '';
                    itemArrastando = null;
                    const grupoLetra = e.target.closest('.team-list').dataset.grupo;
                    atualizarOrdemGrupo(grupoLetra);
                });
            });
        }

        // Fun√ß√£o auxiliar para determinar onde soltar o elemento
        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.team-item:not(.dragging)')];
            
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        // Atualiza a ordem dos times no grupo
        function atualizarOrdemGrupo(grupoLetra) {
            const grupoIndex = grupoOrdenado.findIndex(g => g.letra === grupoLetra);
            const list = document.querySelector(`[data-grupo="${grupoLetra}"]`);
            
            if (!list) return;
            
            const novosTimes = Array.from(list.children).map(item => item.dataset.time);
            grupoOrdenado[grupoIndex].times = novosTimes;
            
            Array.from(list.children).forEach((item, index) => {
                item.className = 'team-item';
                if (index === 0) item.classList.add('primeiro');
                else if (index === 1) item.classList.add('segundo');
                else if (index === 2) item.classList.add('terceiro');
                else item.classList.add('quarto');
                
                const posElement = item.querySelector('.team-pos');
                if (posElement) {
                    posElement.textContent = index + 1;
                }
            });
        }

        // Calcula os classificados baseado na ordem atual
        function calcularPrimeirosESegundos() {
            classificados = { primeiros: [], segundos: [], terceiros: [] };
            todosTerceirosDisponiveis = [];
            
            grupoOrdenado.forEach(grupo => {
                const times = grupo.times;
                
                classificados.primeiros.push({ 
                    grupo: grupo.letra, 
                    time: times[0]
                });
                
                classificados.segundos.push({ 
                    grupo: grupo.letra, 
                    time: times[1]
                });
                
                todosTerceirosDisponiveis.push({
                    grupo: grupo.letra,
                    time: times[2]
                });
            });
            
            return classificados;
        }

        // Abre o modal para sele√ß√£o e ordena√ß√£o dos terceiros
        function abrirModalSelecaoTerceiros() {
            calcularPrimeirosESegundos();
            melhoresTerceirosOrdenados = [];
            
            // Renderizar terceiros dispon√≠veis
            const containerDisponiveis = document.getElementById('terceiros-disponiveis');
            containerDisponiveis.innerHTML = '';
            
            todosTerceirosDisponiveis.forEach((terceiro, index) => {
                const item = document.createElement('div');
                item.className = 'terceiro-item';
                item.dataset.grupo = terceiro.grupo;
                item.dataset.time = terceiro.time;
                item.draggable = true;
                item.innerHTML = `
                    <div class="team-flag">${flags[terceiro.time] || 'üè¥'}</div>
                    <div>
                        <div class="team-name">${terceiro.time}</div>
                        <div class="terceiro-group">Grupo ${terceiro.grupo}</div>
                    </div>
                    <i class="fas fa-arrows-alt-v" style="color: #aaa; margin-left: auto;"></i>
                `;
                
                containerDisponiveis.appendChild(item);
            });
            
            // Limpar slots
            document.querySelectorAll('.slot').forEach(slot => {
                slot.classList.remove('filled');
                const slotLabel = slot.querySelector('.slot-label');
                slotLabel.textContent = slot.dataset.slot === '1' ? 'Melhor terceiro colocado' : 
                                      slot.dataset.slot === '2' ? '2¬∫ melhor terceiro' :
                                      slot.dataset.slot === '3' ? '3¬∫ melhor terceiro' :
                                      slot.dataset.slot === '4' ? '4¬∫ melhor terceiro' :
                                      slot.dataset.slot === '5' ? '5¬∫ melhor terceiro' :
                                      slot.dataset.slot === '6' ? '6¬∫ melhor terceiro' :
                                      slot.dataset.slot === '7' ? '7¬∫ melhor terceiro' : '8¬∫ melhor terceiro';
            });
            
            atualizarContadorSelecao();
            configurarDragAndDropModal();
            document.getElementById('modal-terceiros').classList.add('active');
        }

        // Configura drag-and-drop para o modal
        function configurarDragAndDropModal() {
            const slots = document.querySelectorAll('.slot');
            const disponiveis = document.getElementById('terceiros-disponiveis');
            
            // Eventos para itens dispon√≠veis
            disponiveis.addEventListener('dragstart', (e) => {
                if (e.target.classList.contains('terceiro-item')) {
                    itemArrastando = e.target;
                    e.target.classList.add('dragging');
                    setTimeout(() => {
                        e.target.style.opacity = '0.4';
                    }, 0);
                }
            });
            
            disponiveis.addEventListener('dragend', (e) => {
                if (e.target.classList.contains('terceiro-item')) {
                    e.target.classList.remove('dragging');
                    e.target.style.opacity = '';
                    itemArrastando = null;
                }
            });
            
            // Eventos para slots
            slots.forEach(slot => {
                slot.addEventListener('dragover', (e) => {
                    e.preventDefault();
                });
                
                slot.addEventListener('dragenter', (e) => {
                    e.preventDefault();
                    if (itemArrastando && !slot.classList.contains('filled')) {
                        slot.style.backgroundColor = '#e8f5e9';
                    }
                });
                
                slot.addEventListener('dragleave', (e) => {
                    if (itemArrastando && !slot.classList.contains('filled')) {
                        slot.style.backgroundColor = '';
                    }
                });
                
                slot.addEventListener('drop', (e) => {
                    e.preventDefault();
                    slot.style.backgroundColor = '';
                    
                    if (itemArrastando && !slot.classList.contains('filled')) {
                        // Remover de qualquer slot existente
                        document.querySelectorAll('.slot').forEach(s => {
                            if (s.querySelector(`[data-time="${itemArrastando.dataset.time}"]`)) {
                                s.classList.remove('filled');
                                const label = s.querySelector('.slot-label');
                                label.textContent = s.dataset.slot === '1' ? 'Melhor terceiro colocado' : 
                                                   s.dataset.slot === '2' ? '2¬∫ melhor terceiro' :
                                                   s.dataset.slot === '3' ? '3¬∫ melhor terceiro' :
                                                   s.dataset.slot === '4' ? '4¬∫ melhor terceiro' :
                                                   s.dataset.slot === '5' ? '5¬∫ melhor terceiro' :
                                                   s.dataset.slot === '6' ? '6¬∫ melhor terceiro' :
                                                   s.dataset.slot === '7' ? '7¬∫ melhor terceiro' : '8¬∫ melhor terceiro';
                            }
                        });
                        
                        // Adicionar ao novo slot
                        const clone = itemArrastando.cloneNode(true);
                        clone.style.opacity = '1';
                        clone.classList.remove('dragging');
                        clone.draggable = false;
                        clone.style.cursor = 'default';
                        
                        const label = slot.querySelector('.slot-label');
                        label.innerHTML = `
                            <div class="team-name">${itemArrastando.dataset.time}</div>
                            <div class="terceiro-group">Grupo ${itemArrastando.dataset.grupo}</div>
                        `;
                        
                        slot.classList.add('filled');
                        
                        // Adicionar bot√£o de remover
                        const removeBtn = document.createElement('button');
                        removeBtn.innerHTML = '<i class="fas fa-times" style="color: #ff4757;"></i>';
                        removeBtn.style.background = 'none';
                        removeBtn.style.border = 'none';
                        removeBtn.style.cursor = 'pointer';
                        removeBtn.style.marginLeft = 'auto';
                        removeBtn.addEventListener('click', () => {
                            slot.classList.remove('filled');
                            label.textContent = slot.dataset.slot === '1' ? 'Melhor terceiro colocado' : 
                                              slot.dataset.slot === '2' ? '2¬∫ melhor terceiro' :
                                              slot.dataset.slot === '3' ? '3¬∫ melhor terceiro' :
                                              slot.dataset.slot === '4' ? '4¬∫ melhor terceiro' :
                                              slot.dataset.slot === '5' ? '5¬∫ melhor terceiro' :
                                              slot.dataset.slot === '6' ? '6¬∫ melhor terceiro' :
                                              slot.dataset.slot === '7' ? '7¬∫ melhor terceiro' : '8¬∫ melhor terceiro';
                            atualizarContadorSelecao();
                        });
                        
                        slot.appendChild(removeBtn);
                        
                        atualizarContadorSelecao();
                    }
                });
            });
            
            // Permitir arrastar de volta para dispon√≠veis
            disponiveis.addEventListener('dragover', (e) => {
                e.preventDefault();
            });
            
            disponiveis.addEventListener('drop', (e) => {
                e.preventDefault();
                if (itemArrastando && !itemArrastando.parentElement.classList.contains('terceiros-container')) {
                    // Remover do slot
                    document.querySelectorAll('.slot').forEach(slot => {
                        if (slot.querySelector(`[data-time="${itemArrastando.dataset.time}"]`)) {
                            slot.classList.remove('filled');
                            const label = slot.querySelector('.slot-label');
                            label.textContent = slot.dataset.slot === '1' ? 'Melhor terceiro colocado' : 
                                              slot.dataset.slot === '2' ? '2¬∫ melhor terceiro' :
                                              slot.dataset.slot === '3' ? '3¬∫ melhor terceiro' :
                                              slot.dataset.slot === '4' ? '4¬∫ melhor terceiro' :
                                              slot.dataset.slot === '5' ? '5¬∫ melhor terceiro' :
                                              slot.dataset.slot === '6' ? '6¬∫ melhor terceiro' :
                                              slot.dataset.slot === '7' ? '7¬∫ melhor terceiro' : '8¬∫ melhor terceiro';
                        }
                    });
                    
                    itemArrastando.style.opacity = '1';
                    atualizarContadorSelecao();
                }
            });
        }

        // Atualiza o contador de sele√ß√£o
        function atualizarContadorSelecao() {
            const slotsPreenchidos = document.querySelectorAll('.slot.filled').length;
            const contador = document.getElementById('contador-selecionados');
            const btnConfirmar = document.getElementById('btn-confirmar-terceiros');
            
            contador.textContent = slotsPreenchidos;
            
            if (slotsPreenchidos === 8) {
                btnConfirmar.disabled = false;
                btnConfirmar.innerHTML = '<i class="fas fa-check"></i> Confirmar e Gerar Chaveamento Oficial';
            } else {
                btnConfirmar.disabled = true;
                btnConfirmar.innerHTML = `<i class="fas fa-check"></i> Selecione mais ${8 - slotsPreenchidos}`;
            }
        }

        // ====================================================================
        // FUN√á√ïES PRINCIPAIS DO CHAVEAMENTO OFICIAL FIFA
        // ====================================================================

        // Determina qual terceiro colocado vai para qual jogo baseado na ordem do usu√°rio
        function determinarTerceiroParaJogo(numeroJogo, gruposPossiveis) {
            // Buscar entre os terceiros ordenados (do melhor para o pior)
            for (let i = 0; i < melhoresTerceirosOrdenados.length; i++) {
                const terceiro = melhoresTerceirosOrdenados[i];
                // Verificar se o grupo deste terceiro est√° nos grupos permitidos
                if (gruposPossiveis.includes(terceiro.grupo)) {
                    // Remover da lista para n√£o ser reutilizado
                    melhoresTerceirosOrdenados.splice(i, 1);
                    return terceiro.time;
                }
            }
            return 'Time Indefinido';
        }

        // MONTA O CHAVEAMENTO OFICIAL FIFA 2026
        function montarChaveamentoOficialFIFA() {
            // 1. Encontrar classificados por grupo
            const primeirosPorGrupo = {};
            const segundosPorGrupo = {};
            
            classificados.primeiros.forEach(p => primeirosPorGrupo[p.grupo] = p.time);
            classificados.segundos.forEach(s => segundosPorGrupo[s.grupo] = s.time);
            
            // 2. Preparar lista de terceiros ordenados (do melhor para o pior)
            melhoresTerceirosOrdenados = [];
            document.querySelectorAll('.slot.filled').forEach(slot => {
                const slotNum = parseInt(slot.dataset.slot);
                const time = slot.querySelector('.team-name').textContent;
                const grupo = slot.querySelector('.terceiro-group').textContent.replace('Grupo ', '');
                melhoresTerceirosOrdenados[slotNum - 1] = { grupo, time };
            });
            
            // Criar uma c√≥pia para usar nas determina√ß√µes
            let terceirosParaAlocacao = [...melhoresTerceirosOrdenados];
            
            // 3. MONTAR OS 16 JOGOS DA FASE DE 32
            
            // Jogo 73: 2A vs 2B
            chaveamentoOficial.r32[0] = {
                a: segundosPorGrupo['A'] || '2A',
                b: segundosPorGrupo['B'] || '2B',
                vencedor: null,
                numero: 73
            };
            
            // Jogo 74: 1E vs 3rd (A/B/C/D/F)
            chaveamentoOficial.r32[1] = {
                a: primeirosPorGrupo['E'] || '1E',
                b: encontrarTerceiroParaGrupos(['A', 'B', 'C', 'D', 'F'], terceirosParaAlocacao),
                vencedor: null,
                numero: 74
            };
            
            // Jogo 75: 1F vs 2C
            chaveamentoOficial.r32[2] = {
                a: primeirosPorGrupo['F'] || '1F',
                b: segundosPorGrupo['C'] || '2C',
                vencedor: null,
                numero: 75
            };
            
            // Jogo 76: 1C vs 2F
            chaveamentoOficial.r32[3] = {
                a: primeirosPorGrupo['C'] || '1C',
                b: segundosPorGrupo['F'] || '2F',
                vencedor: null,
                numero: 76
            };
            
            // Jogo 77: 1I vs 3rd (C/D/F/G/H)
            chaveamentoOficial.r32[4] = {
                a: primeirosPorGrupo['I'] || '1I',
                b: encontrarTerceiroParaGrupos(['C', 'D', 'F', 'G', 'H'], terceirosParaAlocacao),
                vencedor: null,
                numero: 77
            };
            
            // Jogo 78: 2E vs 2I
            chaveamentoOficial.r32[5] = {
                a: segundosPorGrupo['E'] || '2E',
                b: segundosPorGrupo['I'] || '2I',
                vencedor: null,
                numero: 78
            };
            
            // Jogo 79: 1A vs 3rd (C/E/F/H/I)
            chaveamentoOficial.r32[6] = {
                a: primeirosPorGrupo['A'] || '1A',
                b: encontrarTerceiroParaGrupos(['C', 'E', 'F', 'H', 'I'], terceirosParaAlocacao),
                vencedor: null,
                numero: 79
            };
            
            // Jogo 80: 1L vs 3rd (E/H/I/J/K)
            chaveamentoOficial.r32[7] = {
                a: primeirosPorGrupo['L'] || '1L',
                b: encontrarTerceiroParaGrupos(['E', 'H', 'I', 'J', 'K'], terceirosParaAlocacao),
                vencedor: null,
                numero: 80
            };
            
            // Jogo 81: 1D vs 3rd (B/E/F/I/J)
            chaveamentoOficial.r32[8] = {
                a: primeirosPorGrupo['D'] || '1D',
                b: encontrarTerceiroParaGrupos(['B', 'E', 'F', 'I', 'J'], terceirosParaAlocacao),
                vencedor: null,
                numero: 81
            };
            
            // Jogo 82: 1G vs 3rd (A/E/H/I/J)
            chaveamentoOficial.r32[9] = {
                a: primeirosPorGrupo['G'] || '1G',
                b: encontrarTerceiroParaGrupos(['A', 'E', 'H', 'I', 'J'], terceirosParaAlocacao),
                vencedor: null,
                numero: 82
            };
            
            // Jogo 83: 2K vs 2L
            chaveamentoOficial.r32[10] = {
                a: segundosPorGrupo['K'] || '2K',
                b: segundosPorGrupo['L'] || '2L',
                vencedor: null,
                numero: 83
            };
            
            // Jogo 84: 1H vs 2J
            chaveamentoOficial.r32[11] = {
                a: primeirosPorGrupo['H'] || '1H',
                b: segundosPorGrupo['J'] || '2J',
                vencedor: null,
                numero: 84
            };
            
            // Jogo 85: 1B vs 3rd (E/F/G/I/J)
            chaveamentoOficial.r32[12] = {
                a: primeirosPorGrupo['B'] || '1B',
                b: encontrarTerceiroParaGrupos(['E', 'F', 'G', 'I', 'J'], terceirosParaAlocacao),
                vencedor: null,
                numero: 85
            };
            
            // Jogo 86: 1J vs 2H
            chaveamentoOficial.r32[13] = {
                a: primeirosPorGrupo['J'] || '1J',
                b: segundosPorGrupo['H'] || '2H',
                vencedor: null,
                numero: 86
            };
            
            // Jogo 87: 1K vs 3rd (D/E/I/J/L)
            chaveamentoOficial.r32[14] = {
                a: primeirosPorGrupo['K'] || '1K',
                b: encontrarTerceiroParaGrupos(['D', 'E', 'I', 'J', 'L'], terceirosParaAlocacao),
                vencedor: null,
                numero: 87
            };
            
            // Jogo 88: 2D vs 2G
            chaveamentoOficial.r32[15] = {
                a: segundosPorGrupo['D'] || '2D',
                b: segundosPorGrupo['G'] || '2G',
                vencedor: null,
                numero: 88
            };
            
            // Ativar indicador de fase
            faseAtual = '32avos';
            atualizarIndicadorFase();
            document.getElementById('phase-indicator').classList.add('active');
            document.getElementById('bracket-section').classList.add('active');
            
            // Renderizar e mostrar
            renderizarChaveamentoOficial();
            
            todasFasesCompletas = false;
            atualizarStatus();
            verificarFaseCompleta();
            atualizarBotaoVoltarFase();
            
            document.getElementById('bracket-section').scrollIntoView({ behavior: 'smooth' });
        }

        // Encontra terceiro para grupos espec√≠ficos (considerando ordem do usu√°rio)
        function encontrarTerceiroParaGrupos(gruposPermitidos, terceirosLista) {
            for (let i = 0; i < terceirosLista.length; i++) {
                if (terceirosLista[i] && gruposPermitidos.includes(terceirosLista[i].grupo)) {
                    const time = terceirosLista[i].time;
                    terceirosLista.splice(i, 1); // Remove para n√£o reutilizar
                    return time;
                }
            }
            return 'Time Indefinido';
        }

        // Confirma a sele√ß√£o dos terceiros e monta o chaveamento OFICIAL
        function confirmarSelecaoTerceiros() {
            const slotsPreenchidos = document.querySelectorAll('.slot.filled').length;
            
            if (slotsPreenchidos !== 8) {
                alert('Por favor, selecione e ordene exatamente 8 terceiros colocados.');
                return;
            }
            
            // Coletar terceiros ordenados
            classificados.terceiros = [];
            document.querySelectorAll('.slot.filled').forEach(slot => {
                const slotNum = parseInt(slot.dataset.slot);
                const time = slot.querySelector('.team-name').textContent;
                const grupo = slot.querySelector('.terceiro-group').textContent.replace('Grupo ', '');
                classificados.terceiros.push({ grupo, time, posicao: slotNum });
            });
            
            document.getElementById('modal-terceiros').classList.remove('active');
            
            montarChaveamentoOficialFIFA();
        }

        // RENDERIZA O CHAVEAMENTO OFICIAL FIFA
        function renderizarChaveamentoOficial() {
            // Limpar colunas
            const idsColunas = [
                'round-32-left', 'round-32-right',
                'round-16-left', 'round-16-right',
                'quarters-left', 'quarters-right',
                'semis-left', 'semis-right'
            ];
            
            idsColunas.forEach(id => {
                const container = document.getElementById(id);
                if (container) {
                    const title = container.querySelector('.round-title');
                    container.innerHTML = '';
                    if (title) container.appendChild(title);
                }
            });
            
            // Renderizar 16-avos (divididos entre esquerda e direita)
            const round32Left = document.getElementById('round-32-left');
            const round32Right = document.getElementById('round-32-right');
            
            // Primeiros 8 jogos √† esquerda
            chaveamentoOficial.r32.slice(0, 8).forEach((jogo, idx) => {
                const match = criarElementoConfrontoOficial('r32', idx, jogo);
                round32Left.appendChild(match);
            });
            
            // √öltimos 8 jogos √† direita
            chaveamentoOficial.r32.slice(8, 16).forEach((jogo, idx) => {
                const match = criarElementoConfrontoOficial('r32', idx + 8, jogo);
                round32Right.appendChild(match);
            });
            
            // Se j√° houver jogos das oitavas definidos, renderiz√°-los
            if (chaveamentoOficial.r16.some(j => j.a)) {
                renderizarRodadaOficial('r16');
            }
            
            // Se j√° houver jogos das quartas definidos, renderiz√°-los
            if (chaveamentoOficial.qf.some(j => j.a)) {
                renderizarRodadaOficial('qf');
            }
            
            // Se j√° houver jogos das semis definidos, renderiz√°-los
            if (chaveamentoOficial.sf.some(j => j.a)) {
                renderizarRodadaOficial('sf');
            }
            
            // Renderizar Final e 3¬∫ Lugar
            renderizarFinalETerceiro();
            
            configurarEventosChaveamentoOficial();
        }

        // Renderiza uma rodada espec√≠fica (oitavas, quartas, etc.)
        function renderizarRodadaOficial(rodada) {
            const colunaMap = {
                'r16': { left: 'round-16-left', right: 'round-16-right' },
                'qf': { left: 'quarters-left', right: 'quarters-right' },
                'sf': { left: 'semis-left', right: 'semis-right' }
            };
            
            const colunas = colunaMap[rodada];
            if (!colunas) return;
            
            const leftContainer = document.getElementById(colunas.left);
            const rightContainer = document.getElementById(colunas.right);
            
            if (!leftContainer || !rightContainer) return;
            
            // Limpar colunas
            leftContainer.querySelectorAll('.match').forEach(m => m.remove());
            rightContainer.querySelectorAll('.match').forEach(m => m.remove());
            
            const jogos = chaveamentoOficial[rodada];
            const metade = Math.ceil(jogos.length / 2);
            
            // Primeira metade √† esquerda
            jogos.slice(0, metade).forEach((jogo, idx) => {
                if (jogo.a) {
                    const match = criarElementoConfrontoOficial(rodada, idx, jogo);
                    leftContainer.appendChild(match);
                }
            });
            
            // Segunda metade √† direita
            jogos.slice(metade).forEach((jogo, idx) => {
                if (jogo.a) {
                    const match = criarElementoConfrontoOficial(rodada, idx + metade, jogo);
                    rightContainer.appendChild(match);
                }
            });
        }

        // Renderiza Final e 3¬∫ Lugar
        function renderizarFinalETerceiro() {
            const finalMatch = document.getElementById('final-match');
            const thirdPlaceMatch = document.getElementById('third-place-match');
            
            // Final
            if (chaveamentoOficial.final[0].a) {
                const conf = chaveamentoOficial.final[0];
                finalMatch.innerHTML = `
                    <div class="team ${conf.vencedor === conf.a ? 'winner' : ''}" data-match="final-0" data-team="a">
                        <span><span class="flag">${flags[conf.a] || 'üè¥'}</span> <span class="name">${conf.a}</span></span>
                    </div>
                    <div class="team ${conf.vencedor === conf.b ? 'winner' : ''}" data-match="final-0" data-team="b">
                        <span><span class="flag">${flags[conf.b] || 'üè¥'}</span> <span class="name">${conf.b}</span></span>
                    </div>
                    <div class="match-number">Final - Jogo ${conf.numero}</div>
                `;
            }
            
            // 3¬∫ Lugar
            if (chaveamentoOficial.terceiro[0].a) {
                const conf = chaveamentoOficial.terceiro[0];
                thirdPlaceMatch.innerHTML = `
                    <div class="team ${conf.vencedor === conf.a ? 'winner' : ''}" data-match="terceiro-0" data-team="a">
                        <span><span class="flag">${flags[conf.a] || 'üè¥'}</span> <span class="name">${conf.a}</span></span>
                    </div>
                    <div class="team ${conf.vencedor === conf.b ? 'winner' : ''}" data-match="terceiro-0" data-team="b">
                        <span><span class="flag">${flags[conf.b] || 'üè¥'}</span> <span class="name">${conf.b}</span></span>
                    </div>
                    <div class="match-number">3¬∫ Lugar - Jogo ${conf.numero}</div>
                `;
            }
        }

        // Cria elemento de confronto OFICIAL (com n√∫mero do jogo)
        function criarElementoConfrontoOficial(fase, idx, conf) {
            const match = document.createElement('div');
            match.className = 'match';
            
            // Estilo especial para a final
            if (conf.numero === 104) {
                match.classList.add('final-match');
            }
            
            match.innerHTML = `
                <div class="team ${conf.vencedor === conf.a ? 'winner' : ''}" data-match="${fase}-${idx}" data-team="a">
                    <span><span class="flag">${flags[conf.a] || 'üè¥'}</span> <span class="name">${conf.a}</span></span>
                </div>
                <div class="team ${conf.vencedor === conf.b ? 'winner' : ''}" data-match="${fase}-${idx}" data-team="b">
                    <span><span class="flag">${flags[conf.b] || 'üè¥'}</span> <span class="name">${conf.b}</span></span>
                </div>
                <div class="match-number">Jogo ${conf.numero}</div>
            `;
            return match;
        }

        // CONFIGURA EVENTOS DO CHAVEAMENTO OFICIAL
        function configurarEventosChaveamentoOficial() {
            document.querySelectorAll('.team').forEach(team => {
                team.addEventListener('click', function() {
                    if (todasFasesCompletas) return;
                    
                    const matchData = this.dataset.match;
                    const teamSide = this.dataset.team;
                    
                    if (!matchData) return;
                    
                    const [fase, index] = matchData.split('-');
                    const matchIdx = parseInt(index);
                    
                    // Salvar estado atual antes de modificar
                    salvarEstadoFase();
                    
                    let confronto;
                    switch(fase) {
                        case 'r32': confronto = chaveamentoOficial.r32[matchIdx]; break;
                        case 'r16': confronto = chaveamentoOficial.r16[matchIdx]; break;
                        case 'qf': confronto = chaveamentoOficial.qf[matchIdx]; break;
                        case 'sf': confronto = chaveamentoOficial.sf[matchIdx]; break;
                        case 'final': confronto = chaveamentoOficial.final[matchIdx]; break;
                        case 'terceiro': confronto = chaveamentoOficial.terceiro[matchIdx]; break;
                    }
                    
                    if (confronto && confronto.a && confronto.b) {
                        confronto.vencedor = teamSide === 'a' ? confronto.a : confronto.b;
                        
                        // Verificar se a fase est√° completa e avan√ßar
                        verificarEAvancarFase(fase);
                        
                        renderizarChaveamentoOficial();
                        atualizarStatus();
                        verificarFaseCompleta();
                        atualizarBotaoVoltarFase();
                        atualizarIndicadorFase();
                    }
                });
            });
        }

        // VERIFICA SE FASE EST√Å COMPLETA E AVAN√áA (OFICIAL FIFA)
        function verificarEAvancarFase(faseAtualJogo) {
            let faseCompleta = false;
            let jogosFase = [];
            
            switch(faseAtual) {
                case '32avos':
                    jogosFase = chaveamentoOficial.r32;
                    faseCompleta = jogosFase.every(j => j.vencedor);
                    if (faseCompleta) avancarParaOitavas();
                    break;
                case '16avos':
                    jogosFase = chaveamentoOficial.r16;
                    faseCompleta = jogosFase.every(j => j.vencedor);
                    if (faseCompleta) avancarParaQuartas();
                    break;
                case 'quartas':
                    jogosFase = chaveamentoOficial.qf;
                    faseCompleta = jogosFase.every(j => j.vencedor);
                    if (faseCompleta) avancarParaSemifinais();
                    break;
                case 'semifinal':
                    jogosFase = chaveamentoOficial.sf;
                    faseCompleta = jogosFase.every(j => j.vencedor);
                    if (faseCompleta) avancarParaFinal();
                    break;
            }
        }

        // AVAN√áA PARA OITAVAS (SEGUINDO BRACKET OFICIAL)
        function avancarParaOitavas() {
            // Jogo 89: Vencedor 74 vs Vencedor 77
            chaveamentoOficial.r16[0] = {
                a: encontrarVencedorPorNumero(74),
                b: encontrarVencedorPorNumero(77),
                vencedor: null,
                numero: 89
            };
            
            // Jogo 90: Vencedor 73 vs Vencedor 75
            chaveamentoOficial.r16[1] = {
                a: encontrarVencedorPorNumero(73),
                b: encontrarVencedorPorNumero(75),
                vencedor: null,
                numero: 90
            };
            
            // Jogo 91: Vencedor 76 vs Vencedor 78
            chaveamentoOficial.r16[2] = {
                a: encontrarVencedorPorNumero(76),
                b: encontrarVencedorPorNumero(78),
                vencedor: null,
                numero: 91
            };
            
            // Jogo 92: Vencedor 79 vs Vencedor 80
            chaveamentoOficial.r16[3] = {
                a: encontrarVencedorPorNumero(79),
                b: encontrarVencedorPorNumero(80),
                vencedor: null,
                numero: 92
            };
            
            // Jogo 93: Vencedor 83 vs Vencedor 84
            chaveamentoOficial.r16[4] = {
                a: encontrarVencedorPorNumero(83),
                b: encontrarVencedorPorNumero(84),
                vencedor: null,
                numero: 93
            };
            
            // Jogo 94: Vencedor 81 vs Vencedor 82
            chaveamentoOficial.r16[5] = {
                a: encontrarVencedorPorNumero(81),
                b: encontrarVencedorPorNumero(82),
                vencedor: null,
                numero: 94
            };
            
            // Jogo 95: Vencedor 86 vs Vencedor 88
            chaveamentoOficial.r16[6] = {
                a: encontrarVencedorPorNumero(86),
                b: encontrarVencedorPorNumero(88),
                vencedor: null,
                numero: 95
            };
            
            // Jogo 96: Vencedor 85 vs Vencedor 87
            chaveamentoOficial.r16[7] = {
                a: encontrarVencedorPorNumero(85),
                b: encontrarVencedorPorNumero(87),
                vencedor: null,
                numero: 96
            };
            
            faseAtual = '16avos';
            atualizarIndicadorFase();
        }

        // AVAN√áA PARA QUARTAS (SEGUINDO BRACKET OFICIAL)
        function avancarParaQuartas() {
            // Jogo 97: Vencedor 89 vs Vencedor 90
            chaveamentoOficial.qf[0] = {
                a: encontrarVencedorPorNumero(89),
                b: encontrarVencedorPorNumero(90),
                vencedor: null,
                numero: 97
            };
            
            // Jogo 98: Vencedor 93 vs Vencedor 94
            chaveamentoOficial.qf[1] = {
                a: encontrarVencedorPorNumero(93),
                b: encontrarVencedorPorNumero(94),
                vencedor: null,
                numero: 98
            };
            
            // Jogo 99: Vencedor 91 vs Vencedor 92
            chaveamentoOficial.qf[2] = {
                a: encontrarVencedorPorNumero(91),
                b: encontrarVencedorPorNumero(92),
                vencedor: null,
                numero: 99
            };
            
            // Jogo 100: Vencedor 95 vs Vencedor 96
            chaveamentoOficial.qf[3] = {
                a: encontrarVencedorPorNumero(95),
                b: encontrarVencedorPorNumero(96),
                vencedor: null,
                numero: 100
            };
            
            faseAtual = 'quartas';
            atualizarIndicadorFase();
        }

        // AVAN√áA PARA SEMIFINAIS (SEGUINDO BRACKET OFICIAL)
        function avancarParaSemifinais() {
            // Jogo 101: Vencedor 97 vs Vencedor 98
            chaveamentoOficial.sf[0] = {
                a: encontrarVencedorPorNumero(97),
                b: encontrarVencedorPorNumero(98),
                vencedor: null,
                numero: 101
            };
            
            // Jogo 102: Vencedor 99 vs Vencedor 100
            chaveamentoOficial.sf[1] = {
                a: encontrarVencedorPorNumero(99),
                b: encontrarVencedorPorNumero(100),
                vencedor: null,
                numero: 102
            };
            
            faseAtual = 'semifinal';
            atualizarIndicadorFase();
        }

        // AVAN√áA PARA FINAL (SEGUINDO BRACKET OFICIAL)
        function avancarParaFinal() {
            // Final: Vencedor 101 vs Vencedor 102
            chaveamentoOficial.final[0] = {
                a: encontrarVencedorPorNumero(101),
                b: encontrarVencedorPorNumero(102),
                vencedor: null,
                numero: 104
            };
            
            // 3¬∫ Lugar: Perdedor 101 vs Perdedor 102
            const perdedor101 = encontrarPerdedorPorNumero(101);
            const perdedor102 = encontrarPerdedorPorNumero(102);
            
            chaveamentoOficial.terceiro[0] = {
                a: perdedor101,
                b: perdedor102,
                vencedor: null,
                numero: 103
            };
            
            faseAtual = 'final';
            atualizarIndicadorFase();
        }

        // Encontra vencedor pelo n√∫mero do jogo
        function encontrarVencedorPorNumero(numeroJogo) {
            // Procurar em todas as rodadas
            const todasRodadas = [...chaveamentoOficial.r32, ...chaveamentoOficial.r16, 
                                 ...chaveamentoOficial.qf, ...chaveamentoOficial.sf];
            
            const jogo = todasRodadas.find(j => j.numero === numeroJogo);
            return jogo ? jogo.vencedor : `Vencedor ${numeroJogo}`;
        }

        // Encontra perdedor pelo n√∫mero do jogo
        function encontrarPerdedorPorNumero(numeroJogo) {
            const todasRodadas = [...chaveamentoOficial.r32, ...chaveamentoOficial.r16, 
                                 ...chaveamentoOficial.qf, ...chaveamentoOficial.sf];
            
            const jogo = todasRodadas.find(j => j.numero === numeroJogo);
            if (!jogo || !jogo.vencedor) return `Perdedor ${numeroJogo}`;
            
            return jogo.vencedor === jogo.a ? jogo.b : jogo.a;
        }

        // ====================================================================
        // FUN√á√ïES DE CONTROLE E UTILIT√ÅRIAS
        // ====================================================================

        // ATUALIZA INDICADOR DE FASE
        function atualizarIndicadorFase() {
            const indicatorText = document.getElementById('current-phase-text');
            const instructionText = document.getElementById('phase-instruction');
            
            let faseTexto = '';
            let instrucaoTexto = '';
            
            switch(faseAtual) {
                case '32avos':
                    faseTexto = 'Selecionando vencedores dos 16-avos de final';
                    instrucaoTexto = 'Clique em um time para definir o vencedor de cada confronto';
                    break;
                case '16avos':
                    faseTexto = 'Selecionando vencedores das oitavas de final';
                    instrucaoTexto = 'Clique em um time para definir o vencedor de cada confronto';
                    break;
                case 'quartas':
                    faseTexto = 'Selecionando vencedores das quartas de final';
                    instrucaoTexto = 'Clique em um time para definir o vencedor de cada confronto';
                    break;
                case 'semifinal':
                    faseTexto = 'Selecionando vencedores das semifinais';
                    instrucaoTexto = 'Clique em um time para definir o vencedor de cada confronto';
                    break;
                case 'final':
                    faseTexto = 'Selecionando vencedor da final e do 3¬∫ lugar';
                    instrucaoTexto = 'Clique para definir o campe√£o e o 3¬∫ colocado';
                    break;
            }
            
            indicatorText.textContent = faseTexto;
            instructionText.textContent = instrucaoTexto;
        }

        // SALVA ESTADO NO HIST√ìRICO
        function salvarEstadoFase() {
            historicoFases.push({
                fase: faseAtual,
                chaveamento: JSON.parse(JSON.stringify(chaveamentoOficial)),
                classificados: JSON.parse(JSON.stringify(classificados)),
                melhoresTerceirosOrdenados: [...melhoresTerceirosOrdenados]
            });
            
            if (historicoFases.length > 10) {
                historicoFases.shift();
            }
        }

        // LIMPA FASES POSTERIORES √Ä FASE ATUAL
        function limparFasesPosteriores(fase) {
            const ordemFases = ['32avos', '16avos', 'quartas', 'semifinal', 'final'];
            const indiceFase = ordemFases.indexOf(fase);
            
            // Limpar todas as fases ap√≥s a fase atual
            for (let i = indiceFase + 1; i < ordemFases.length; i++) {
                const fasePosterior = ordemFases[i];
                
                switch(fasePosterior) {
                    case '16avos':
                        chaveamentoOficial.r16.forEach(jogo => {
                            jogo.a = null;
                            jogo.b = null;
                            jogo.vencedor = null;
                        });
                        break;
                    case 'quartas':
                        chaveamentoOficial.qf.forEach(jogo => {
                            jogo.a = null;
                            jogo.b = null;
                            jogo.vencedor = null;
                        });
                        break;
                    case 'semifinal':
                        chaveamentoOficial.sf.forEach(jogo => {
                            jogo.a = null;
                            jogo.b = null;
                            jogo.vencedor = null;
                        });
                        break;
                    case 'final':
                        chaveamentoOficial.final[0].a = null;
                        chaveamentoOficial.final[0].b = null;
                        chaveamentoOficial.final[0].vencedor = null;
                        chaveamentoOficial.terceiro[0].a = null;
                        chaveamentoOficial.terceiro[0].b = null;
                        chaveamentoOficial.terceiro[0].vencedor = null;
                        break;
                }
            }
        }

        // VOLTA PARA A FASE ANTERIOR E LIMPA FASES POSTERIORES
        function voltarParaFaseAnterior() {
            const ordemFases = ['32avos', '16avos', 'quartas', 'semifinal', 'final'];
            const indiceAtual = ordemFases.indexOf(faseAtual);
            
            // Se j√° est√° na primeira fase, n√£o faz nada
            if (indiceAtual <= 0) return;
            
            // Limpa todas as fases a partir da fase atual
            limparFasesPosteriores(ordemFases[indiceAtual - 1]);
            
            // Define a fase anterior como atual
            faseAtual = ordemFases[indiceAtual - 1];
            
            // Remove todos os vencedores da fase atual (para permitir nova sele√ß√£o)
            switch(faseAtual) {
                case '32avos':
                    chaveamentoOficial.r32.forEach(jogo => {
                        jogo.vencedor = null;
                    });
                    break;
                case '16avos':
                    chaveamentoOficial.r16.forEach(jogo => {
                        if (jogo.a) jogo.vencedor = null;
                    });
                    break;
                case 'quartas':
                    chaveamentoOficial.qf.forEach(jogo => {
                        if (jogo.a) jogo.vencedor = null;
                    });
                    break;
                case 'semifinal':
                    chaveamentoOficial.sf.forEach(jogo => {
                        if (jogo.a) jogo.vencedor = null;
                    });
                    break;
            }
            
            // Limpa o hist√≥rico (n√£o queremos voltar mais de uma fase de uma vez)
            historicoFases = [];
            
            // Atualiza a interface
            renderizarChaveamentoOficial();
            atualizarStatus();
            verificarFaseCompleta();
            atualizarBotaoVoltarFase();
            atualizarIndicadorFase();
        }

        // ATUALIZA BOT√ÉO VOLTAR FASE
        function atualizarBotaoVoltarFase() {
            const backButton = document.getElementById('back-phase-fixed');
            // Mostrar bot√£o se n√£o estiver na fase de 32-avos (primeira fase do mata-mata)
            backButton.classList.toggle('active', faseAtual !== '32avos');
        }

        // VERIFICA SE FASE EST√Å COMPLETA (para mostrar controle)
        function verificarFaseCompleta() {
            const control = document.getElementById('phase-control-above');
            
            let faseCompleta = false;
            let proximaFase = '';
            let textoFase = '';
            
            switch(faseAtual) {
                case '32avos':
                    faseCompleta = chaveamentoOficial.r32.every(j => j.vencedor);
                    proximaFase = '16avos';
                    textoFase = '16-avos de Final';
                    break;
                case '16avos':
                    faseCompleta = chaveamentoOficial.r16.every(j => j.vencedor);
                    proximaFase = 'quartas';
                    textoFase = 'Oitavas de Final';
                    break;
                case 'quartas':
                    faseCompleta = chaveamentoOficial.qf.every(j => j.vencedor);
                    proximaFase = 'semifinal';
                    textoFase = 'Quartas de Final';
                    break;
                case 'semifinal':
                    faseCompleta = chaveamentoOficial.sf.every(j => j.vencedor);
                    proximaFase = 'final';
                    textoFase = 'Semifinais';
                    break;
                case 'final':
                    faseCompleta = chaveamentoOficial.final[0].vencedor && chaveamentoOficial.terceiro[0].vencedor;
                    proximaFase = 'completo';
                    textoFase = 'Final';
                    break;
            }
            
            if (faseCompleta && proximaFase !== 'completo') {
                control.innerHTML = `
                    <h3>${textoFase} Conclu√≠da!</h3>
                    <p>Todos os confrontos da ${textoFase.toLowerCase()} foram definidos.</p>
                    <div class="phase-control-buttons">
                        <button class="btn-phase" id="btn-avancar-fase">
                            <i class="fas fa-arrow-right"></i> Avan√ßar para ${proximaFase === '16avos' ? 'Oitavas' : proximaFase === 'quartas' ? 'Quartas' : proximaFase === 'semifinal' ? 'Semifinais' : 'Final'}
                        </button>
                        <button class="btn-back" id="btn-voltar-fase">
                            <i class="fas fa-undo"></i> Voltar para ${faseAtual === '16avos' ? '16-avos' : faseAtual === 'quartas' ? 'Oitavas' : faseAtual === 'semifinal' ? 'Quartas' : 'Semifinais'}
                        </button>
                    </div>
                `;
                control.classList.add('active');
                
                document.getElementById('btn-avancar-fase').addEventListener('click', () => {
                    salvarEstadoFase();
                    verificarEAvancarFase(faseAtual);
                    renderizarChaveamentoOficial();
                    control.classList.remove('active');
                    atualizarIndicadorFase();
                });
                
                document.getElementById('btn-voltar-fase').addEventListener('click', voltarParaFaseAnterior);
            } else if (proximaFase === 'completo' && faseCompleta) {
                const campeao = chaveamentoOficial.final[0].vencedor;
                const terceiro = chaveamentoOficial.terceiro[0].vencedor;
                control.innerHTML = `
                    <h3>üèÜ Copa do Mundo 2026 Conclu√≠da!</h3>
                    <p>Campe√£o: <strong>${campeao}</strong> ${flags[campeao] || 'üèÜ'}</p>
                    <p>3¬∫ Lugar: <strong>${terceiro}</strong> ${flags[terceiro] || 'ü•â'}</p>
                    <div class="phase-control-buttons">
                        <button class="btn-phase" id="btn-nova-simulacao2">
                            <i class="fas fa-redo"></i> Iniciar Nova Simula√ß√£o
                        </button>
                        <button class="btn-back" id="btn-voltar-final">
                            <i class="fas fa-undo"></i> Voltar para Semifinais
                        </button>
                    </div>
                `;
                control.classList.add('active');
                todasFasesCompletas = true;
                
                document.getElementById('btn-nova-simulacao2').addEventListener('click', novaSimulacao);
                document.getElementById('btn-voltar-final').addEventListener('click', voltarParaFaseAnterior);
            } else {
                control.classList.remove('active');
            }
        }

        // ATUALIZA BARRA DE STATUS
        function atualizarStatus() {
            const statusGrupos = document.getElementById('status-grupos');
            const statusTextGrupos = document.getElementById('status-text-grupos');
            const statusMata = document.getElementById('status-mata');
            const statusTextMata = document.getElementById('status-text-mata');
            const statusFase = document.getElementById('status-fase');
            const statusTextFase = document.getElementById('status-text-fase');
            
            statusGrupos.className = 'status-icon active';
            statusTextGrupos.textContent = 'Definida pelo usu√°rio';
            
            if (chaveamentoOficial.r32[0].a) {
                statusMata.className = 'status-icon active';
                
                let faseTexto = '';
                switch(faseAtual) {
                    case '32avos': faseTexto = '16-avos de Final'; break;
                    case '16avos': faseTexto = 'Oitavas de Final'; break;
                    case 'quartas': faseTexto = 'Quartas de Final'; break;
                    case 'semifinal': faseTexto = 'Semifinais'; break;
                    case 'final': faseTexto = 'Final'; break;
                }
                
                statusTextMata.textContent = `Em andamento (${faseTexto})`;
                statusTextFase.textContent = faseTexto;
                statusFase.className = 'status-icon active';
            } else {
                statusMata.className = 'status-icon waiting';
                statusTextMata.textContent = 'Aguardando montagem';
                statusTextFase.textContent = '-';
                statusFase.className = 'status-icon waiting';
            }
        }

        // NOVA SIMULA√á√ÉO
        function novaSimulacao() {
            grupoOrdenado = JSON.parse(JSON.stringify(gruposData));
            classificados = { primeiros: [], segundos: [], terceiros: [] };
            todosTerceirosDisponiveis = [];
            melhoresTerceirosOrdenados = [];
            
            // Resetar chaveamento oficial
            chaveamentoOficial.r32 = Array(16).fill(null).map((_, i) => ({ 
                a: null, b: null, vencedor: null, numero: 73 + i 
            }));
            chaveamentoOficial.r16 = Array(8).fill(null).map((_, i) => ({ 
                a: null, b: null, vencedor: null, numero: 89 + i 
            }));
            chaveamentoOficial.qf = Array(4).fill(null).map((_, i) => ({ 
                a: null, b: null, vencedor: null, numero: 97 + i 
            }));
            chaveamentoOficial.sf = Array(2).fill(null).map((_, i) => ({ 
                a: null, b: null, vencedor: null, numero: 101 + i 
            }));
            chaveamentoOficial.final[0] = { a: null, b: null, vencedor: null, numero: 104 };
            chaveamentoOficial.terceiro[0] = { a: null, b: null, vencedor: null, numero: 103 };
            
            faseAtual = '32avos';
            todasFasesCompletas = false;
            historicoFases = [];
            
            renderizarGrupos();
            renderizarChaveamentoOficial();
            atualizarStatus();
            
            // Esconder elementos do mata-mata
            document.getElementById('bracket-section').classList.remove('active');
            document.getElementById('phase-indicator').classList.remove('active');
            document.getElementById('phase-control-above').classList.remove('active');
            document.getElementById('back-phase-fixed').classList.remove('active');
        }

        // CONFIGURA EVENTOS DOS BOT√ïES
        function configurarEventos() {
            // Bot√£o para abrir modal de sele√ß√£o
            document.getElementById('btn-montar-chaveamento').addEventListener('click', abrirModalSelecaoTerceiros);
            
            // Bot√£o para redefinir grupos
            document.getElementById('btn-reset-grupos').addEventListener('click', () => {
                grupoOrdenado = JSON.parse(JSON.stringify(gruposData));
                renderizarGrupos();
                atualizarStatus();
            });
            
            // Bot√£o para nova simula√ß√£o
            document.getElementById('btn-nova-simulacao').addEventListener('click', novaSimulacao);
            
            // Bot√£o fixo para voltar fase
            document.getElementById('btn-voltar-fase-fixo').addEventListener('click', voltarParaFaseAnterior);
            
            // Bot√µes do modal
            document.getElementById('btn-confirmar-terceiros').addEventListener('click', confirmarSelecaoTerceiros);
            document.getElementById('btn-cancelar-selecao').addEventListener('click', () => {
                document.getElementById('modal-terceiros').classList.remove('active');
            });
            document.getElementById('close-modal').addEventListener('click', () => {
                document.getElementById('modal-terceiros').classList.remove('active');
            });
            
            // Fechar modal clicando fora
            document.getElementById('modal-terceiros').addEventListener('click', (e) => {
                if (e.target === document.getElementById('modal-terceiros')) {
                    document.getElementById('modal-terceiros').classList.remove('active');
                }
            });
        }
    </script>
</body>
</html>
